# Настройка интернационализации (i18n)

Это руководство описывает, как настроить и использовать интернационализацию в ksqlDB UI.

## Конфигурация

Добавьте параметр `language` в ваш конфигурационный файл:

```toml
# config/local.toml
language = "ru"  # Поддерживаемые языки: "en", "ru"
```

## Использование в шаблонах

В Jinja2 шаблонах используйте теги `{% trans %}` для переводимых строк:

```jinja2
{% trans %}Hello, world!{% endtrans %}
{% trans %}Welcome to ksqlDB UI{% endtrans %}

<!-- Для строк с переменными -->
{% trans name=user.name %}Hello, {{ name }}!{% endtrans %}

<!-- Для множественного числа -->
{% trans count=items|length %}
  {%- if count == 1 -%}
    Found {{ count }} item
  {%- else -%}
    Found {{ count }} items
  {%- endif -%}
{% endtrans %}
```

## Использование в Python коде

Импортируйте функции перевода из модуля i18n:

```python
from .core.i18n import _, ngettext

# Простой перевод
message = _("Hello, world!")

# Множественное число
message = ngettext(
    "Found %d item",
    "Found %d items",
    count
) % count
```

## Извлечение строк для перевода

1. Запустите скрипт извлечения:
```bash
./scripts/extract_translations.sh
```

Этот скрипт:
- Создает файл `locale/messages.pot` с извлеченными строками
- Создает или обновляет файлы `.po` для каждого языка

## Редактирование переводов

Отредактируйте файлы `.po` в директории `locale/`:

- `locale/ru/LC_MESSAGES/messages.po` - русские переводы
- `locale/en/LC_MESSAGES/messages.po` - английские переводы

Пример содержимого `.po` файла:
```po
#: src/templates/base.html:18
msgid "Hello, world!"
msgstr "Привет, мир!"

#: src/templates/status/index.html:25
msgid "Server Status"
msgstr "Статус сервера"
```

## Компиляция переводов

После редактирования `.po` файлов, скомпилируйте их в `.mo` файлы:

```bash
./scripts/compile_translations.sh
```

## Добавление нового языка

1. Добавьте код языка в `SUPPORTED_LANGUAGES` в `src/app/core/i18n.py`
2. Запустите `./scripts/extract_translations.sh` для создания файлов перевода
3. Отредактируйте новый `.po` файл
4. Скомпилируйте переводы

## Структура файлов

```
locale/
├── messages.pot           # Шаблон переводов
├── en/
│   └── LC_MESSAGES/
│       ├── messages.po    # Английские переводы
│       └── messages.mo    # Скомпилированные переводы
└── ru/
    └── LC_MESSAGES/
        ├── messages.po    # Русские переводы
        └── messages.mo    # Скомпилированные переводы
```

## Workflow разработки

1. Добавьте `{% trans %}` теги в шаблоны или используйте `_()` в Python коде
2. Запустите `./scripts/extract_translations.sh`
3. Отредактируйте `.po` файлы
4. Запустите `./scripts/compile_translations.sh`
5. Перезапустите приложение

## Зависимости

Убедитесь, что Babel установлен:
```bash
pip install Babel
```

Или используйте pipenv:
```bash
pipenv install Babel
```
